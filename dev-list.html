
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
      integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
      crossorigin="anonymous">
      <script src="https://unpkg.com/vue"></script>
    </head>
    <body>
      <script type="text/x-template" id="item-template">
        <li :class="model.displayClass">
          <div
            :class="{bold: isFolder}"
            @click="toggle"
            @dblclick="changeType">
            <span v-if="isFolder" :class='open ? "glyphicon glyphicon-minus":"glyphicon glyphicon-plus"'></span>
            <span v-else><img :src='micon'></span>
            {{model.name}}

          </div>
          <ul v-show="open" v-if="isFolder">
            <item
              class="item"
              v-for="model in model.children"
              :model="model">
            </item>
            <!-- <li class="add" @click="addChild">+</li> -->
          </ul>
        </li>
      </script>

<div id="demo">
<ul id="demo">
  <item
    class="item"
    :model="treeData">
  </item>
</ul>
</div>

    </body>
    <script type="text/javascript">
    // demo data
    var greendot='http://maps.google.com/mapfiles/ms/icons/green-dot.png';
    var reddot='http://maps.google.com/mapfiles/ms/icons/red-dot.png';
    var cameradot ='http://maps.google.com/mapfiles/ms/icons/blue.png'
    var gatewaydot ='http://maps.google.com/mapfiles/ms/icons/purple.png'

var data = {
  name: 'My Sensor Network',
  children: [
    {
      name: 'Sensor Node Group 1',
      children: [
        { name: 'Sensor Node #1' ,
          displayClass: 'alert-success level2 ',
          entitytype: 'sensornode' },
        { name: 'Sensor Node #2',
          displayClass: 'alert-warning level2 ',
        entitytype: 'sensornode' },
        { name: 'Sensor Node #11' ,
          displayClass: 'alert-success level2 ',
        entitytype: 'sensornode' },
        { name: 'Sensor Node #12' ,
          displayClass: 'alert-success level2 ',
        entitytype: 'sensornode' }
      ],
      displayClass: 'alert-warning level1 ',
      entitytype: 'group'
    },
    { name: 'Gateway #1' ,
      displayClass: 'alert-success level1 ',
      entitytype: 'gateway'
    },
    { name: 'Video Node #1',
      displayClass: 'alert-success level1',
      entitytype: 'videonode' }
  ],
  displayClass: 'level0',
  entitytype: 'network'
}

// define the item component
Vue.component('item', {
template: '#item-template',
props: {
  model: Object
},
data: function () {
  return {
    open: false
  }
},
computed: {
  isFolder: function () {
    return this.model.children &&
      this.model.children.length
  },
  micon:function(){
    switch(this.model.entitytype){
      case 'gateway':
        return gatewaydot;
      case 'videonode':
        return cameradot;
      case 'sensornode':
        if(this.model.displayClass.includes('success')){
          return greendot;
        }else {
          return reddot;
        }
      default:
       return '';
    }
  }
},
methods: {
  toggle: function () {
    if (this.isFolder) {
      this.open = !this.open
    }else {
      console.log("Clicked "+this.model.name);
    }
  },
  changeType: function () {
    if (!this.isFolder) {
      Vue.set(this.model, 'children', [])
      this.addChild()
      this.open = true
    }
  },
  addChild: function () {
    this.model.children.push({
      name: 'new stuff'
    })
  }
}
})

// boot up the demo
var demo = new Vue({
el: '#demo',
data: {
  treeData: data
}
})
</script>
<style>
.item {
  cursor: pointer;
}
.bold {
  font-weight: bold;
}
ul {
  padding-left: 0px;
  line-height: 1.5em;
  list-style: none;
}
li {
  padding-top:4px;
  padding-bottom:4px;
}
li span {
  width: 30px;
  text-align:center;
}
li.level0 {
    font-size: 28px;
    padding-left 5px;
}
li.level1{
      padding-left 15px;
    font-size: 24px;
    font-weight: bold;
    margin:5px 0px;
}
li.level2 {
    padding-left 25px;
    font-size: 20px;
    font-weight:400;
    margin:1px 0px;
}
</style>
</html>
